define("wiki-activity:widget/moments-2014/authorityComments/authorityComments.js",function(t){function i(t,i){var o=parseInt(n("#authorityComments .viewport .gallery").css("left")),e=101*(l-t);r({duration:100*Math.log(Math.abs(e)+1),easing:"easeIn",onStep:function(t){n("#authorityComments .viewport .gallery").css("left",o+e*t)},onComplete:function(){l=t,i&&i()}})}function o(t,i){var o=n("#authorityComments .viewport .gallery li").eq(u),e=n("#authorityComments .viewport .gallery li").eq(t);m.play(t),r({duration:500,easing:"easeInOut",onStep:function(i){t!==u&&(o.width(124-25*i).css(u+8!==l&&u!==l?{marginLeft:4-4*i,marginRight:6-4*i}:{marginLeft:u+8===l?0:8-8*i,marginRight:u+8===l?10-8*i:2}),e.width(99+25*i).css(t+8!==l&&t!==l?{marginLeft:0+4*i,marginRight:2+4*i}:{marginLeft:0+(t+8===l?0:8)*i,marginRight:2+(t+8===l?8:0)*i}),o.children(".authority_avator").css({marginTop:0+15*i,width:125-25*i,height:150-30*i}),o.children(".authority_title").css({opacity:1*i}),e.children(".authority_avator").css({marginTop:15-15*i,width:99+25*i,height:120+30*i}),e.children(".authority_title").css({opacity:1-1*i}),o.find(".authority_avator_shadow").css({width:116-25*i,height:142-30*i,opacity:1-1*i}),e.find(".authority_avator_shadow").css({width:91+25*i,height:112+30*i,opacity:1*i}))},onComplete:function(){u=t,"function"==typeof i&&i()}})}function e(){n("#authorityComments .viewport .button").on("click",function(){if(n(this).hasClass("button-next"))var t=h>l+9?l+9:h-1,r=l+1;else if(n(this).hasClass("button-prev"))var t=l-9>8?l-9:8,r=l-9;t!==l&&(n("#authorityComments .button").off("click"),n("#authorityComments .gallery li .authority_avator").off("click"),i(t,function(){e(),9>t?(n("#authorityComments .viewport .button-prev").addClass("button-hide"),n("#authorityComments .viewport .button-next").removeClass("button-hide")):t>=9&&h-1>t?(n("#authorityComments .viewport .button-prev").addClass("button-hide"),n("#authorityComments .viewport .button-next").addClass("button-hide")):t===h-1&&(n("#authorityComments .viewport .button-next").addClass("button-hide"),n("#authorityComments .viewport .button-prev").removeClass("button-hide")),t-9>=u||u>t?o(r,a):a()}))})}function a(){n("#authorityComments .viewport .gallery li .authority_avator").on("click",function(){var t=n(this).parent("li").index();t!==u&&(n("#authorityComments .gallery li .authority_avator").off("click"),o(t,a))})}var n=t("wiki-common:widget/lib/jquery/jquery.js"),r=t("wiki-common:widget/util/animation.js"),s=t("wiki-common:widget/ui/carousel/carousel.js"),h=n("#authorityComments .viewport .gallery li").length,u=4,l=8;n("#authorityComments .viewport .gallery li").eq(u).children(".authority_title").css({opacity:0}),n("#authorityComments .viewport .gallery li").eq(u).find(".authority_avator_shadow").css({opacity:1}),n("#authorityComments .viewport .button-prev").addClass("button-hide");var m=new s({container:n("#authorityComments .screen .gallery"),aniUnitSize:{width:940,height:300},autoPlayInterval:0,aniConfig:{duration:500,direction:"left"}});m.play(4),e(),a()});
;define("wiki-activity:widget/moments-2014/guide/guideElements.js",function(t,e,i){function n(t,e){return{x:(e.width()-s)/2/e.scaleX()+t.x/e.scaleX(),y:(e.height()-c)/2/e.scaleX()+t.y/e.scaleX()}}var a=t("wiki-common:widget/lib/jquery/jquery.js"),o=t("wiki-common:widget/lib/kinetic/kinetic.js"),s=a("#momentsGuide").width(),c=a("#momentsGuide").height(),r=1.2,d={};d.logo=new Image,d.logo.src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/logo_41b4313.png",d.slogan=new Image,d.slogan.src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/slogan_2916df6.png",d.text=[];for(var g=0;10>g;g++)d.text.push(new Image);d.text[0].src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/momentsGuide_title-0_6bf9fbc.png",d.text[1].src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/momentsGuide_title-1_4b141ac.png",d.text[2].src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/momentsGuide_title-2_60416b5.png",d.text[3].src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/momentsGuide_title-3_0f4e7d3.png",d.text[4].src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/momentsGuide_title-4_7aa3eba.png",d.text[5].src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/momentsGuide_title-5_afa3012.png",d.text[6].src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/momentsGuide_title-6_a26bea6.png",d.text[7].src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/momentsGuide_title-7_997aa21.png",d.text[8].src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/momentsGuide_title-8_bf80556.png",d.text[9].src="http://baike.bdimg.com/static/wiki-activity/widget/moments-2014/guide/resource/img/momentsGuide_title-9_998c0aa.png";var m=function(t){d.text[0].onload=t},u={};u.layer=function(t){var e=t||{},i=e.width/e.scale*r,n=e.height/e.scale*r,a=(e.width-i)/2,s=(e.height-n)/2;return new o.Layer({x:a,y:s,width:i,height:n,scale:{x:e.scale,y:e.scale}})},u.logo=function(){var t=new o.Rect({x:1280*r-70,y:236,width:175,height:360,scale:{x:.8,y:.8},opacity:0,fillPatternImage:d.logo,fillPatternScale:{x:.5,y:.5}}),e=function(){new o.Tween({node:t,x:1280*r-81,y:200,scaleX:1,scaleY:1,opacity:1,duration:1.25,easing:o.Easings.EaseOut}).play()};return t.startAni=e,t},u.slogan=function(){var t=new o.Rect({x:1500,y:572,width:258,height:70,opacity:0,fillPatternImage:d.slogan}),e=function(){new o.Tween({node:t,x:1540,y:564,opacity:1,duration:1,easing:o.Easings.EaseOut}).play()};return t.startAni=e,t},u.line=function(t){var e=t||{};e.delay=e.delay||0,e.coor=n({x:e.x,y:e.y},e.layer),e.lineLength=Math.sqrt(Math.pow(e.width,2)+Math.pow(e.height,2)),e.rad=(e.degree+90)/180*Math.PI,e.end=[0,0,-e.lineLength*Math.cos(e.rad),-e.lineLength*Math.sin(e.rad)],e.strokeWidth=e.strokeWidth||.5;var i=new o.Line({x:e.coor.x,y:e.coor.y,points:[0,0,0,0],strokeWidth:e.strokeWidth,stroke:e.color,tension:1}),a=function(){setTimeout(function(){new o.Tween({node:i,points:e.end,duration:2,easing:o.Easings.EaseIn}).play()},e.delay)};return i.startAni=a,i},u.dot=function(t){var e=t||{};e.textOffset=e.textOffset||{x:0,y:0},e.delay=e.delay||0,e.coor=n({x:e.x,y:e.y},e.layer),e.lineLength=Math.sqrt(Math.pow(e.width,2)+Math.pow(e.height,2)),e.rad=(e.degree+90)/180*Math.PI,e.end=[e.lineLength*Math.cos(e.rad),e.lineLength*Math.sin(e.rad),-e.lineLength*Math.cos(e.rad),-e.lineLength*Math.sin(e.rad)],e.strokeWidth=e.strokeWidth||.5,e.textLength=e.text.length,e.producedText="";for(var i=0;i<e.textLength;i++)e.producedText+=e.text.substr(i,1),i+1<e.textLength&&(e.producedText+="\n");var a=new o.Circle({x:e.coor.x,y:e.coor.y,radius:0,fill:"#397ddb",opacity:0}),s=new o.Rect({x:e.coor.x+e.textOffset.x+5,y:e.coor.y+e.textOffset.y+30,width:20,height:120,scale:{x:.5,y:.5},opacity:0,fillPatternImage:d.text[e.textIdx],fillPatternRepeat:"no-repeat"}),c=function(){setTimeout(function(){new o.Tween({node:a,radius:12,opacity:1,duration:.6,easing:o.Easings.EaseIn}).play(),setTimeout(function(){new o.Tween({node:a,radius:3,opacity:1,duration:1.4,easing:o.Easings.EaseOut}).play()},600),setTimeout(function(){new o.Tween({node:s,x:e.coor.x+e.textOffset.x-1,y:e.coor.y+e.textOffset.y-6,scaleX:1.1,scaleY:1.1,opacity:1,duration:.5,easing:o.Easings.Linear}).play(),setTimeout(function(){new o.Tween({node:s,x:e.coor.x+e.textOffset.x,y:e.coor.y+e.textOffset.y,scaleX:1,scaleY:1,duration:.8,easing:o.Easings.EaseOut}).play()},500)},2e3)},e.delay)},r=new o.Group;return r.add(a,s),r.startAni=c,r},i.exports={build:u,onload:m}});
;define("wiki-activity:widget/moments-2014/mainRanking/mainRanking.js",function(n,i,e){function t(n){var i=r("#mainRanking .viewport").offset().left,e=r(this).offset().left,t=e-i+n.offsetX,a=t-r("#mainRanking .viewport").width()/2,o=a/(r("#mainRanking .viewport").width()/2);return{left:t,extent:o}}function a(){var n=0;r("#mainRanking .gallery li").each(function(){n+=r(this).width()}),n+=34;var i=[0,r("#mainRanking .viewport").width()-n],e=parseInt(r("#mainRanking .gallery").css("left"));if(Math.abs(c)>.6&&(0>c&&e<i[0]||c>0&&e>i[1])){var t=3*Math.pow(Math.abs(c)+.5,5)*(c>0?-1:1),o=e+t;o<i[1]?o=i[1]:o>i[0]&&(o=i[0]),r("#mainRanking .gallery").css("left",o)}e<i[1]&&r("#mainRanking .gallery").css("left",i[1]),requestAnimationFrame(function(){a()})}function o(){var n=r(window).width(),i=r("#mainRanking").width();if(n>=i)var e=i;else if(i>n&&n>980)var e=n;else var e=980;r("#mainRanking .viewport").width(e)}function s(){var n=function(n,i){var e=n.width(),t="mouseenter"===i?514-e:170-e,a=Math.abs(t)/344*750,o=u({duration:a,easing:"easeInOut",onStep:function(i){n.css("width",e+i*t)}});"mouseenter"===i?n.on("mouseleave",function(){o.stop()}):n.on("mouseenter",function(){o.stop()})},i=function(n,i){var e=n.find(".title"),t=n.find(".shadow"),a=n.find(".cover"),o="",s="",r=parseFloat(t.css("opacity")),m="mouseenter"===i?0-r:.8-r,c=1e3*Math.abs(m),l=parseFloat(a.css("opacity")),w="mouseenter"===i?0-l:1-l,f=300*Math.abs(w);"mouseenter"===i&&(s=u({duration:f,easing:"easeInOut",onStep:function(n){var i=l+n*w;a.css("opacity",i),e.css("opacity",i)}})),o=u({duration:c,easing:"easeInOut",onStep:function(n){var i=r+n*m;t.css("opacity",i)},onComplete:function(){"mouseleave"===i&&(s=u({duration:f,easing:"easeInOut",onStep:function(n){var i=l+n*w;a.css("opacity",i),e.css("opacity",i)}}))}}),"mouseenter"===i?n.on("mouseleave",function(){o.stop(),s.stop&&s.stop()}):n.on("mouseenter",function(){o.stop(),s.stop&&s.stop()})};m("transition")?(r("#mainRanking .gallery").addClass("cssTransition"),r("#mainRanking .viewport li").on("mouseenter",function(){r(this).addClass("hover"),i(r(this),"mouseenter")}),r("#mainRanking .viewport li").on("mouseleave",function(){r(this).removeClass("hover"),i(r(this),"mouseleave")})):(r("#mainRanking .viewport li").on("mouseenter",function(){n(r(this),"mouseenter"),i(r(this),"mouseenter")}),r("#mainRanking .viewport li").on("mouseleave",function(){n(r(this),"mouseleave"),i(r(this),"mouseleave")})),r("#mainRanking .viewport").on("mousemove",function(n){var i=n.target,e=t.call(i,n);c=e.extent}),r("#mainRanking .viewport").on("mouseleave",function(){c=0}),a()}var r=n("wiki-common:widget/lib/jquery/jquery.js"),m=n("wiki-common:widget/util/checkCSS.js"),u=n("wiki-common:widget/util/animation.js");!function(){for(var n=0,i=["webkit","moz"],e=0;e<i.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[i[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[e]+"CancelAnimationFrame"]||window[i[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(i){var e=(new Date).getTime(),t=Math.max(0,16.7-(e-n)),a=window.setTimeout(function(){i(e+t)},t);return n=e+t,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})}(),o(),r(window).on("resize",function(){o()});var c=0,l={init:function(n){function i(n,i,e){var e=e||0;u({duration:i,easing:"easeIn",delay:e,onStep:function(i){n.css("opacity",1*i)},onComplete:function(){(0===e||601===e)&&s()}})}if(n){r("#mainRanking").css("opacity",1);var e=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19];e.sort(function(){return.5-Math.random()});for(var t=0;20>t;t++){i(r("#mainRanking .gallery li").eq(e[t]),800,50*t+1)}}else r("#mainRanking .gallery li").css("opacity",1),i(r("#mainRanking"),2e3,0)}};e.exports=l});
;define("wiki-activity:widget/moments-2014/scroll/scroll.js",function(o,e,n){var i=o("wiki-common:widget/lib/jquery/jquery.js"),l=o("wiki-common:widget/util/animation.js"),t={};t.getScrollTop=function(o){if(o)var e=o.offset().top;else var e=i("body").scrollTop()?i("body").scrollTop():i("html").scrollTop();return e},t.scrollTo=function(o,e,n){t.isScrolling=!0;var r=t.getScrollTop(),c="undefined"!=typeof o?o:r,s=function(){return!1};i(window.document).on("mousewheel",s);l({duration:150*Math.log(Math.abs(c-r)+1),delay:e||0,easing:"easeInOut",onStep:function(o){i("html, body").scrollTop(r+(c-r)*o)},onComplete:function(){i(window.document).off("mousewheel",s),t.isScrolling=!1,n&&n()}})},n.exports=t});
;define("wiki-activity:widget/moments-2014/sideNav/sideNav.js",function(e){var o=e("wiki-common:widget/lib/jquery/jquery.js"),i=e("wiki-common:widget/component/userLogin/userLogin.js"),a=e("wiki-common:widget/component/share/share.js"),n={rules:"",share:""};o("#sideNav li").on("mouseenter",function(){o(this).hasClass("sideNav_item-rule")?(clearTimeout(n.rules),n.rules=setTimeout(function(){o("#rules").show()},300)):o(this).hasClass("sideNav_item-share")&&(clearTimeout(n.share),n.share=setTimeout(function(){o("#shareBar").addClass("expand")},300))}),o("#sideNav li").on("mouseleave",function(){o(this).hasClass("sideNav_item-rule")?(clearTimeout(n.rules),n.rules=setTimeout(function(){o("#rules").hide()},300)):o(this).hasClass("sideNav_item-share")&&(clearTimeout(n.share),n.share=setTimeout(function(){o("#shareBar").removeClass("expand")},300))}),o("#shareBar").on("mouseenter",function(){clearTimeout(n.share)}),o("#shareBar").on("mouseleave",function(){clearTimeout(n.share),o(this).removeClass("expand")}),o("#rules").on("mouseenter",function(){clearTimeout(n.rules)}),o("#rules").on("mouseleave",function(){clearTimeout(n.rules),o(this).hide()}),o("#shareBar").on("click","em",function(){function e(e){a.openShareLink(s,{pic:"http://baike.bdimg.com/cms/static/moments-2014/momemnts-2014-weibo.png",title:"2014年即将离去，站在新旧交替的十字路口回顾过去的一年，哪些关键词让你记忆犹新？哪些画面让你挥之不去？百度百科精心制作年度盘点#史记·2014#，溯古鉴今，记录时代点滴。特色榜单正在火热投票中，想让你的2014记忆铭刻在百度百科的大事记中吗？还等什么，和我一起投票吧→",url:e})}var n=o(this).parent("#shareBar").attr("data-search"),s=o(this).attr("data-channel");if(s)if(n){var t=window.location.protocol+"//"+window.location.host+window.location.pathname+n;e(t)}else i.checkIfLogin({onLogin:function(o){var i=window.location.protocol+"//"+window.location.host+window.location.pathname+"?uid="+o.id;e(i)},onUnlogin:function(){var o=window.location.protocol+"//"+window.location.host+window.location.pathname;e(o)}})})});
;define("wiki-activity:widget/moments-2014/subRankings/subRankings.js",function(n){function t(){}function e(){var n=parseInt(9*Math.random());i(".subRankings-tri .subRankings_content .detail").removeClass("show"),i(".subRankings-tri .subRankings_content .shape").css("opacity",.01),i(".subRankings-tri .subRankings_content").each(function(){i(this).find(".detail").eq(n).addClass("show"),i(this).find(".shape").eq(n).css("opacity",.65)}),g&&setTimeout(function(){g&&e()},1500)}var i=n("wiki-common:widget/lib/jquery/jquery.js"),s=n("wiki-common:widget/util/addStyleSheet.js"),a=n("wiki-common:widget/util/browser.js"),o=n("wiki-common:widget/ui/marquee/marquee.js"),r=n("wiki-common:widget/ui/pager/horPager/horPager.js"),c=n("wiki-common:widget/ui/bubble/bubble.js"),d=n("wiki-common:widget/ui/overlay/overlay.js"),l=n("wiki-common:widget/util/animation.js"),u=n("wiki-common:widget/component/userLogin/userLogin.js"),h=n("wiki-common:widget/component/share/share.js"),p=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1");p||!a.ie()||document.namespaces.v||(document.namespaces.add("v","urn:schemas-microsoft-com:vml"),s({"v\\:shape,v\\:group":"behavior:url(#default#VML);display:inline-block"})),t.prototype={constructor:t,buildArea:function(n){if(p){var t=i(document.createElementNS("http://www.w3.org/2000/svg","path")),e="M"+n[0][0]+","+n[0][1]+" L";for(var s in n)0!==parseInt(s)&&(e+=n[s][0],e+=",",e+=n[s][1],parseInt(s)+1!==n.length&&(e+=","));t.attr({d:e}).attr("class","shape")}else{var t=i(document.createElement("<v:shape/>")),a="m"+n[0][0]+","+n[0][1]+" L";for(var s in n)0!==parseInt(s)&&(a+=n[s][0],a+=",",a+=n[s][1],parseInt(s)+1!==n.length&&(a+=","));t.attr({coordsize:"980, 485",fillcolor:"black",stroked:"false",strokeweight:0,path:a}).addClass("shape")}return t},getNode:function(){if(p)var n=i(document.createElementNS("http://www.w3.org/2000/svg","svg")).attr({width:"100%",height:"100%","class":"svg"});else var n=i("<div>").addClass("vml");return n.append(this.buildArea([[6,0],[310,0],[158,152]])),n.append(this.buildArea([[324,3],[476,155],[172,155]])),n.append(this.buildArea([[338,0],[642,0],[490,152]])),n.append(this.buildArea([[656,3],[808,155],[504,155]])),n.append(this.buildArea([[670,0],[974,0],[822,152]])),n.append(this.buildArea([[324,318],[476,165],[172,165]])),n.append(this.buildArea([[656,318],[808,165],[504,165]])),n.append(this.buildArea([[490,166],[649,325],[490,484],[331,325]])),n.append(this.buildArea([[324,333],[476,485],[172,485]])),n.append(this.buildArea([[656,333],[808,485],[504,485]])),n}},i(".subRankings-tri .subRankings_content li").each(function(){i(this).append((new t).getNode())});var m=new d({opacity:.5});i(".subRankings").each(function(){if(i(this).find(".subRankings_comments")[0]&&i(this).find(".subRankings_comments .viewport ul li").length>2){var n=Math.ceil(i(this).find(".subRankings_comments .viewport ul li").length/2),t=new o({container:i(this).find(".subRankings_comments .viewport ul"),viewportCap:2,unitSize:{width:460,height:80},isContinuous:!0,pausingTriggers:i(this).find(".pager"),onAniStart:function(){e.reset({curIndex:this.targetTick%n+1})},autoScrollInterval:4e3,duration:500}),e=new r({pContainer:i(this).find(".subRankings_comments .pager"),template:"pagerTpl_dot",containsEndTags:!0,conTotalCount:n,conPerPage:1,onIndexChange:function(){t.scroll(this.curIndex-1)}});e.show()}});var g=!0;e(),i(".subRankings-tri .subRankings_content").on("mouseenter",".shape",function(){g=!1,i(".subRankings-tri .subRankings_content .detail").removeClass("show"),i(".subRankings-tri .subRankings_content .shape").css("opacity",.01);var n=i(this).index();i(this).parents("li").find(".detail").eq(n).addClass("show"),i(this).css("opacity",.65)}),i(".subRankings-tri .subRankings_content").on("mouseenter",".detail",function(){g=!1,i(".subRankings-tri .subRankings_content .detail").removeClass("show"),i(".subRankings-tri .subRankings_content .shape").css("opacity",.01);var n=i(this).index();i(this).addClass("show"),i(this).parents("li").find(".shape").eq(n).css("opacity",.65)}),i(".subRankings-tri .subRankings_content").on("mouseleave",".shape",function(){g=!1;var n=i(this).index();i(this).parents("li").find(".detail").eq(n).removeClass("show"),i(this).css("opacity",.01)}),i(".subRankings-tri .subRankings_nav, .subRankings-sqr .subRankings_nav").on("mouseenter","li",function(){if(!i(this).hasClass("actived")){var n=i(this).index(),t=i(this).parents(".subRankings"),e=t.find(".subRankings_nav li"),s=t.find(".subRankings_content li");e.removeClass("actived"),s.removeClass("actived"),e.eq(n).addClass("actived"),s.eq(n).addClass("actived")}}),i(".detail_vote").on("click",function(){var n=i(this).offset(),t=i(this),e=i("<div>"),s=i(this).parents(".detail").find(".detail_counts"),a=i(this).attr("data-search"),o=i(this).attr("data-key");o&&i.ajax({type:"POST",url:"/operation/api/voteshiji2014",data:{key:o},dataType:"JSON",success:function(o){function r(n){m.show(500),i("#shareDialog").fadeIn(500),i("#shareDialog .dialog_share_icon").off("click"),i("#shareDialog .dialog_share_icon").on("click","em",function(){var t=i(this).attr("data-channel");h.openShareLink(t,{pic:"http://baike.bdimg.com/cms/static/moments-2014/momemnts-2014-weibo.png",title:"2014年即将离去，站在新旧交替的十字路口回顾过去的一年，哪些关键词让你记忆犹新？哪些画面让你挥之不去？百度百科精心制作年度盘点#史记·2014#，溯古鉴今，记录时代点滴。特色榜单正在火热投票中，想让你的2014记忆铭刻在百度百科的大事记中吗？还等什么，和我一起投票吧→",url:n})})}switch(o.errno){case 0:if(e.css({position:"absolute","z-index":9,left:n.left+t.width()+5,top:n.top,color:"#fed30d",transform:"scale(0.5)",transformOrigin:"left"}).html('<span style="font-size: 14px">+</span><span style="font-size: 20px">1</span>'),i("body").append(e),l({duration:750,easing:"easeIn",onStep:function(t){var i=.5+1.5*t;e.css({top:n.top-40*t,transform:"scale("+i+")"})},onComplete:function(){s.html(parseInt(s.html())+1)}}),l({duration:300,delay:500,easing:"easeIn",onStep:function(n){e.css({opacity:1-1*n})},onComplete:function(){e.remove()}}),o.restVotes<6){var d=new c({host:t,classNames:"vote-bubble",content:"<div>您今天还剩余 <span>"+o.restVotes+"</span> 票</div>",marginFromHost:9,pos:"ver-auto",showTail:!0,hideAfterDelay:3e3,animation:"FADE"}).show();i(".detail_vote").on("mouseleave",function(){d.hide()})}i(".detail_vote").attr("data-rest",o.restVotes);break;case 1:break;case 2:u.showLoginPop({onLoginSuccess:function(){}});break;case 3:if(a){var p=window.location.protocol+"//"+window.location.host+window.location.pathname+a;r(p)}else u.checkIfLogin({onLogin:function(n){var t=window.location.protocol+"//"+window.location.host+window.location.pathname+"?uid="+n.id;r(t)},onUnlogin:function(){var n=window.location.protocol+"//"+window.location.host+window.location.pathname;r(n)}});break;default:alert("未知错误，请稍后再试")}},error:function(){alert("网络错误，请稍后再试")}})}),i(".detail_vote").on("mouseover",function(){var n=i(this).attr("data-rest");if(6>n){var t=new c({host:i(this),classNames:"vote-bubble",content:"<div>您今天还剩余 <span>"+n+"</span> 票</div>",marginFromHost:9,pos:"auto",showTail:!0,hideAfterDelay:3e3,animation:"FADE"}).show();i(".detail_vote").on("mouseleave",function(){t.hide()})}}),i("#shareDialog .dialog_close").on("click",function(){m.hide(500),i("#shareDialog").fadeOut(500)})});
;var $=require("wiki-common:widget/lib/jquery/jquery.js"),cookie=require("wiki-common:widget/util/cookie.js"),animation=require("wiki-common:widget/util/animation.js"),userLogin=require("wiki-common:widget/component/userLogin/userLogin.js"),scrollExt=require("wiki-activity:widget/moments-2014/scroll/scroll.js"),Overlay=require("wiki-common:widget/ui/overlay/overlay.js"),mainRanking=require("wiki-activity:widget/moments-2014/mainRanking/mainRanking.js"),isGuiding=!1,isTwinkleInit=!1,allowRulesGuide=!1,isRulesGuiding=!1;setTimeout(function(){function i(){return scrollExt.getScrollTop()}function s(){var s=$(window).height(),e=i(),o=scrollExt.getScrollTop($("#process")),n=e+s/2;$("#sideNav li, #sideNav dd").removeClass("actived"),n>scrollExt.getScrollTop($(".subRankings-museum"))?($("#sideNav .sideNav_item-subRankings").addClass("actived"),$("#sideNav .sideNav_item-subRankings dl dd").eq(4).addClass("actived")):n>scrollExt.getScrollTop($(".subRankings-tech"))?($("#sideNav .sideNav_item-subRankings").addClass("actived"),$("#sideNav .sideNav_item-subRankings dl dd").eq(3).addClass("actived")):n>scrollExt.getScrollTop($(".subRankings-society"))?($("#sideNav .sideNav_item-subRankings").addClass("actived"),$("#sideNav .sideNav_item-subRankings dl dd").eq(2).addClass("actived")):n>scrollExt.getScrollTop($(".subRankings-net"))?($("#sideNav .sideNav_item-subRankings").addClass("actived"),$("#sideNav .sideNav_item-subRankings dl dd").eq(1).addClass("actived")):n>scrollExt.getScrollTop($(".subRankings-entertain"))?($("#sideNav .sideNav_item-subRankings").addClass("actived"),$("#sideNav .sideNav_item-subRankings dl dd").eq(0).addClass("actived")):$("#sideNav .sideNav_item-mainRanking").addClass("actived"),l||(l=!0,o>e?$("#sideNav").fadeOut(300,function(){l=!1}):e>o-1&&$("#sideNav").fadeIn(300,function(){l=!1}))}function e(){if("1"!=cookie.get("moments2014_rules")){var e=new Overlay({opacity:.5,onShow:function(){$("#rulesGuide").fadeIn(500)}});allowRulesGuide=!0,cookie.set("moments2014_rules","1",{expires:31536e6,path:"/"}),$("#rulesGuide .rulesGuide_confirm").on("click",function(){isRulesGuiding=!1,$(this).parent("#rulesGuide").fadeOut(500),e.hide(500),$("body").css({overflow:"visible"})})}$(window).on("scroll",function(){"0"!==$("#mainRanking").css("opacity")||isTwinkleInit||(clearTimeout(o),mainRanking.init()),i()+$(window).height()>scrollExt.getScrollTop($("#process"))?(isGuiding=!1,allowRulesGuide&&scrollExt.isScrolling&&(isRulesGuiding=!0,e.show(500),$("body").css({overflow:"hidden"})),allowRulesGuide=!1):i()<scrollExt.getScrollTop($("#process"))&&(isGuiding=!0),s()})}var l=!1;if(s(),i()<500){isGuiding=!0;var o=setTimeout(function(){isTwinkleInit=!0,scrollExt.scrollTo(scrollExt.getScrollTop($("#process"))-$(window).height()>0?scrollExt.getScrollTop($("#process"))-$(window).height():0),setTimeout(function(){mainRanking.init(!0)},500)},7e3);scrollExt.scrollTo(0,0,e)}else isGuiding=!1,mainRanking.init(),e();document.createElement("canvas").getContext||(mainRanking.init(),clearTimeout(o)),$(window.document).on("mousewheel",function(s){if(!isRulesGuiding){var e=$(window).height(),l=i(),o=scrollExt.getScrollTop($("#process"));!scrollExt.isScrolling&&isGuiding&&e+l+100>=o&&s.deltaY<0?scrollExt.scrollTo(o):!scrollExt.isScrolling&&!isGuiding&&o>=l-100&&s.deltaY>0&&scrollExt.scrollTo(o-e)}}),$("#sideNav li .sideNav_item_title").on("click",function(){var i=$(this).parent("li"),s=i.attr("data-scroll");if(!scrollExt.isScrolling&&s&&"momentsGuide"!==s);else if(!scrollExt.isScrolling&&s&&"momentsGuide"===s)isGuiding=!0,scrollExt.scrollTo(scrollExt.getScrollTop($("#process"))-$(window).height()>0?scrollExt.getScrollTop($("#process"))-$(window).height():0);else if(i.hasClass("sideNav_item-subRankings")){var e=i.height();if(65===e||210===e){var l=65===e?145:-145;animation({duration:200,easing:"easeIn",onStep:function(s){i.height(e+l*s)}})}}}),$("#sideNav .sideNav_item-subRankings dl").on("click","dd",function(){var i=$(this).attr("data-scroll");!scrollExt.isScrolling&&i&&scrollExt.scrollTo(scrollExt.getScrollTop($(".subRankings-"+i)))})},500);
;define("wiki-activity:widget/moments-2014/guide/guide.js",function(e){var t=e("wiki-common:widget/lib/jquery/jquery.js"),i=e("wiki-common:widget/lib/kinetic/kinetic.js"),l=e("wiki-activity:widget/moments-2014/guide/guideElements.js"),d=t("#momentsGuide").width(),s=t("#momentsGuide").height(),o=[],h={lines:[[],[],[]],dots:[[],[],[]]};l.onload(function(){function e(e,t,i,l){var d={x:e-i/2,y:t-l/2},s={x:d.x/(i/2),y:d.y/(l/2)};return{point:d,extent:s}}function n(e){return Math.pow(e,15)}function r(e){var i=30;t("#momentsGuide canvas").eq(2).css({left:e.extent.x*i*n(o[0].scaleX()),top:e.extent.y*i*n(o[0].scaleX())}),t("#momentsGuide canvas").eq(1).css({left:e.extent.x*i*n(o[1].scaleX()),top:e.extent.y*i*n(o[1].scaleX())}),t("#momentsGuide canvas").eq(0).css({left:e.extent.x*i*n(o[2].scaleX()),top:e.extent.y*i*n(o[2].scaleX())})}var a=new i.Stage({container:"momentsGuide",width:d,height:s}),y=l.build.layer({width:d,height:s,scale:1});o[0]=l.build.layer({width:d,height:s,scale:1}),o[1]=l.build.layer({width:d,height:s,scale:.95}),o[2]=l.build.layer({width:d,height:s,scale:.91}),h.logo=l.build.logo(),h.slogan=l.build.slogan(),h.dots[0].push(l.build.dot({layer:o[0],x:1034,y:601,text:"马航失踪事件",textIdx:9,textOffset:{x:-10,y:-125},delay:500})),h.dots[0].push(l.build.dot({layer:o[0],x:1590,y:496,text:"埃博拉",textIdx:6,textOffset:{x:-10,y:-95},delay:650})),h.lines[0].push(l.build.line({layer:o[0],x:85,y:780,width:d,height:s,degree:79.3,strokeWidth:1.5,color:"#666",delay:800})),h.lines[0].push(l.build.line({layer:o[0],x:318,y:0,width:d,height:s,degree:130,strokeWidth:1.5,color:"#666",delay:950})),h.dots[1].push(l.build.dot({layer:o[1],x:1637,y:80,text:"打老虎",textIdx:2,textOffset:{x:-10,y:-25},delay:1100})),h.dots[1].push(l.build.dot({layer:o[1],x:880,y:140,text:"改革元年",textIdx:0,textOffset:{x:-10,y:-100},delay:1250})),h.dots[1].push(l.build.dot({layer:o[1],x:1120,y:52.5,text:"独立公投",textIdx:5,textOffset:{x:-10,y:-20},delay:1400})),h.dots[1].push(l.build.dot({layer:o[1],x:881,y:500,text:"真人秀",textIdx:7,textOffset:{x:-25,y:-60},delay:1550})),h.dots[1].push(l.build.dot({layer:o[1],x:960,y:299,text:"彭丽媛",textIdx:4,textOffset:{x:-10,y:-95},delay:1700})),h.dots[1].push(l.build.dot({layer:o[1],x:1460,y:241,text:"移动支付",textIdx:3,textOffset:{x:0,y:-100},delay:1850})),h.dots[1].push(l.build.dot({layer:o[1],x:1640,y:580,text:"霾",textIdx:8,textOffset:{x:-10,y:-40},delay:2e3})),h.dots[1].push(l.build.dot({layer:o[1],x:1240,y:640,text:"黄赌毒",textIdx:1,textOffset:{x:0,y:-85},delay:2150})),h.lines[1].push(l.build.line({layer:o[1],x:1400,y:-50,width:d,height:s,degree:250,strokeWidth:1,color:"#999",delay:1500})),h.lines[1].push(l.build.line({layer:o[1],x:1113.5,y:-50,width:d,height:s,degree:130,strokeWidth:1,color:"#ccc",delay:1500})),h.lines[1].push(l.build.line({layer:o[1],x:2560,y:915,width:d,height:s,degree:-70,strokeWidth:1,color:"#ccc",delay:1500})),h.lines[1].push(l.build.line({layer:o[1],x:810,y:900,width:d,height:s,degree:10,strokeWidth:1,color:"#ccc",delay:1500})),h.lines[1].push(l.build.line({layer:o[1],x:0,y:611,width:d,height:s,degree:72,strokeWidth:1,color:"#ccc",delay:1500})),h.lines[1].push(l.build.line({layer:o[1],x:2560,y:873,width:d,height:s,degree:-80,strokeWidth:1,color:"#ccc",delay:1500})),h.lines[2].push(l.build.line({layer:o[2],x:1340,y:800,width:d,height:s,degree:25,color:"#ccc"})),h.lines[2].push(l.build.line({layer:o[2],x:1440,y:800,width:d,height:s,degree:25,color:"#ccc"})),h.lines[2].push(l.build.line({layer:o[2],x:1840,y:0,width:d,height:s,degree:190,color:"#ccc"})),h.lines[2].push(l.build.line({layer:o[2],x:0,y:0,width:d,height:s,degree:115,color:"#ccc"})),h.lines[2].push(l.build.line({layer:o[2],x:0,y:140,width:d,height:s,degree:115,color:"#ccc"})),h.lines[2].push(l.build.line({layer:o[2],x:2560,y:240,width:d,height:s,degree:-80,color:"#ccc"})),h.lines[2].push(l.build.line({layer:o[2],x:560,y:800,width:d,height:s,degree:40,color:"#ccc"})),h.lines[2].push(l.build.line({layer:o[2],x:1240,y:0,width:d,height:s,degree:210,color:"#ccc"})),h.lines[2].push(l.build.line({layer:o[2],x:1380,y:0,width:d,height:s,degree:175,color:"#ccc"})),h.lines[2].push(l.build.line({layer:o[2],x:740,y:0,width:d,height:s,degree:240,color:"#ccc"})),h.lines[2].push(l.build.line({layer:o[2],x:180,y:800,width:d,height:s,degree:50,color:"#ccc"})),function(){for(var e in o){var t=o[e];for(var i in h.lines[e]){var l=h.lines[e][i];t.add(l)}for(var i in h.dots[e]){var d=h.dots[e][i];t.add(d)}}y.add(h.logo),o[0].add(h.slogan),a.add(o[2],o[1],o[0],y);for(var e in h.lines)for(var i in h.lines[e])h.lines[e][i].startAni()&&h.lines[e][e].startAni();for(var e in h.dots)for(var i in h.dots[e])h.dots[e][i].startAni()&&h.dots[e][e].startAni();setTimeout(function(){h.logo.startAni()},5e3),setTimeout(function(){h.slogan.startAni()},6250)}(),t("body").on("mousemove",function(i){var l=t(window).width(),d=t(window).height(),s=e(i.pageX,i.pageY,l,d);r(s)})})});